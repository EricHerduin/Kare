{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/services/diet-book.service\";\nimport * as i3 from \"src/app/services/meal.service\";\nimport * as i4 from \"@angular/common\";\nfunction ArrayDietmealComponent_div_0_ng_container_7_ng_container_5_ng_container_1_span_1_button_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 6);\n    i0.ɵɵlistener(\"click\", function ArrayDietmealComponent_div_0_ng_container_7_ng_container_5_ng_container_1_span_1_button_1_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const meal_r8 = i0.ɵɵnextContext().$implicit;\n      const ctx_r10 = i0.ɵɵnextContext(5);\n      return i0.ɵɵresetView(ctx_r10.onViewMealForm(meal_r8.id));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const meal_r8 = i0.ɵɵnextContext().$implicit;\n    const ctx_r9 = i0.ɵɵnextContext(5);\n    i0.ɵɵclassProp(\"active\", ctx_r9.activeButtonMeal === meal_r8.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r9.getMealSortName(meal_r8), \" \");\n  }\n}\nfunction ArrayDietmealComponent_div_0_ng_container_7_ng_container_5_ng_container_1_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtemplate(1, ArrayDietmealComponent_div_0_ng_container_7_ng_container_5_ng_container_1_span_1_button_1_Template, 2, 3, \"button\", 5);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const meal_r8 = ctx.$implicit;\n    const mealOrderItem_r4 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r7 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r7.getMealSortName(meal_r8) === mealOrderItem_r4);\n  }\n}\nfunction ArrayDietmealComponent_div_0_ng_container_7_ng_container_5_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, ArrayDietmealComponent_div_0_ng_container_7_ng_container_5_ng_container_1_span_1_Template, 2, 1, \"span\", 3);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const stage_r2 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r5.dietMealsByStage[stage_r2]);\n  }\n}\nfunction ArrayDietmealComponent_div_0_ng_container_7_ng_container_5_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"button\", 7);\n    i0.ɵɵtext(2, \"--\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction ArrayDietmealComponent_div_0_ng_container_7_ng_container_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, ArrayDietmealComponent_div_0_ng_container_7_ng_container_5_ng_container_1_Template, 2, 1, \"ng-container\", 0);\n    i0.ɵɵtemplate(2, ArrayDietmealComponent_div_0_ng_container_7_ng_container_5_ng_container_2_Template, 3, 0, \"ng-container\", 0);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const stage_r2 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.dietMealsByStage[stage_r2]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r3.dietMealsByStage[stage_r2]);\n  }\n}\nfunction ArrayDietmealComponent_div_0_ng_container_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"tr\")(2, \"td\", 4);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtemplate(5, ArrayDietmealComponent_div_0_ng_container_7_ng_container_5_Template, 3, 2, \"ng-container\", 3);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const stage_r2 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(stage_r2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.mealOrder);\n  }\n}\nfunction ArrayDietmealComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"table\")(2, \"tr\")(3, \"th\", 1);\n    i0.ɵɵtext(4, \"\\u00C9tape\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\", 2);\n    i0.ɵɵtext(6, \"Repas\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(7, ArrayDietmealComponent_div_0_ng_container_7_Template, 6, 2, \"ng-container\", 3);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.getRange(ctx_r0.dietbook.nbStage));\n  }\n}\nexport class ArrayDietmealComponent {\n  constructor(route, router, dietBookService, mealService) {\n    this.route = route;\n    this.router = router;\n    this.dietBookService = dietBookService;\n    this.mealService = mealService;\n    this.dietbook = null;\n    this.dietMeals = [];\n    this.dietMealsByStage = {};\n    this.mealOrder = [\"Petit-déjeuner\", \"Collation am\", \"Déjeuner\", \"Collation 1\", \"Collation 2\", \"Diner\"];\n  }\n  ngOnInit() {\n    this.route.queryParams.subscribe(params => {\n      this.dietId = params[\"dietId\"];\n      this.dietBookService.getDietBookById(this.dietId).subscribe(dietbook => {\n        this.dietbook = dietbook;\n        if (dietbook.meal) {\n          this.loadDietMeals(dietbook.meal);\n        }\n      });\n    });\n  }\n  loadDietMeals(dietMealIds) {\n    for (const id of dietMealIds) {\n      this.mealService.getMealById(id).subscribe(meal => {\n        this.dietMeals.push(meal);\n        this.organizeMealsByStage();\n      });\n    }\n  }\n  organizeMealsByStage() {\n    // Organise les meals par stage dans dietMealsByStage\n    this.dietMealsByStage = {};\n    for (const meal of this.dietMeals) {\n      for (const stage of meal.stage) {\n        if (!this.dietMealsByStage[stage]) {\n          this.dietMealsByStage[stage] = [];\n        }\n        this.dietMealsByStage[stage].push(meal);\n      }\n    }\n    // Trie les meals dans l'ordre de mealOrder\n    for (const stage in this.dietMealsByStage) {\n      if (this.dietMealsByStage.hasOwnProperty(stage)) {\n        this.dietMealsByStage[stage].sort((a, b) => {\n          let nameA = this.getMealSortName(a);\n          let nameB = this.getMealSortName(b);\n          return this.mealOrder.indexOf(nameA) - this.mealOrder.indexOf(nameB);\n        });\n      }\n    }\n  }\n  getRange(nbStage) {\n    return Array(nbStage).fill(0).map((_, index) => index + 1);\n  }\n  //renomme les collations am-pm1-pm2\n  getMealSortName(meal) {\n    let name = meal.typeMeal;\n    let collation = meal.collation;\n    if (meal.typeMeal === \"Collation\") {\n      if (collation === \"pm1\") {\n        name += \" 1\";\n      } else if (collation === \"pm2\") {\n        name += \" 2\";\n      } else {\n        name += \" \" + collation;\n      }\n    }\n    return name;\n  }\n  onViewMealForm(id) {\n    this.activeButtonMeal = id;\n    this.router.navigateByUrl(`dietbook?dietId=${this.dietId}&mealId=${id}`);\n  }\n  static #_ = this.ɵfac = function ArrayDietmealComponent_Factory(t) {\n    return new (t || ArrayDietmealComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.DietBooksService), i0.ɵɵdirectiveInject(i3.mealService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ArrayDietmealComponent,\n    selectors: [[\"app-array-dietmeal\"]],\n    decls: 1,\n    vars: 1,\n    consts: [[4, \"ngIf\"], [1, \"title\", \"stage-col\", \"col1\"], [1, \"title\", \"stage-col\", \"col2\"], [4, \"ngFor\", \"ngForOf\"], [1, \"stage-col\"], [\"class\", \"displayMeal_btn\", 3, \"active\", \"click\", 4, \"ngIf\"], [1, \"displayMeal_btn\", 3, \"click\"], [1, \"displayMeal_btn\"]],\n    template: function ArrayDietmealComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, ArrayDietmealComponent_div_0_Template, 8, 1, \"div\", 0);\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.dietbook);\n      }\n    },\n    dependencies: [i4.NgForOf, i4.NgIf],\n    styles: [\"button[_ngcontent-%COMP%] {\\n  width: auto;\\n  font-size: 10px;\\n}\\n\\ntable[_ngcontent-%COMP%], td[_ngcontent-%COMP%], tr[_ngcontent-%COMP%] {\\n  margin: 0;\\n}\\n\\ntable[_ngcontent-%COMP%] {\\n  width: 100%;\\n}\\n\\n.active[_ngcontent-%COMP%] {\\n  background-color: rgb(180, 136, 136);\\n}\\n\\n.title[_ngcontent-%COMP%] {\\n  font-size: 30px;\\n}\\n\\n.stage-col[_ngcontent-%COMP%] {\\n  text-align: center;\\n}\\n\\n.col1[_ngcontent-%COMP%] {\\n  width: 20%;\\n}\\n\\n.col2[_ngcontent-%COMP%] {\\n  width: 80%;\\n}\\n\\n.displayMeal_btn[_ngcontent-%COMP%] {\\n  width: 15%;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29yZS9hcnJheS1kaWV0bWVhbC9hcnJheS1kaWV0bWVhbC5jb21wb25lbnQuc2NzcyIsIndlYnBhY2s6Ly8uLy4uLy4uLy4uL1NpdGUlMjBXZWIvQkQyJTIwS29uZWN0L0Zyb250ZW5kL3NyYy9hcHAvY29yZS9hcnJheS1kaWV0bWVhbC9hcnJheS1kaWV0bWVhbC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFdBQUE7RUFDQSxlQUFBO0FDQ0Y7O0FEQ0E7OztFQUdFLFNBQUE7QUNFRjs7QURBQTtFQUNFLFdBQUE7QUNHRjs7QUREQTtFQUNFLG9DQUFBO0FDSUY7O0FERkE7RUFDRSxlQUFBO0FDS0Y7O0FESEE7RUFDRSxrQkFBQTtBQ01GOztBREpBO0VBQ0UsVUFBQTtBQ09GOztBRExBO0VBQ0UsVUFBQTtBQ1FGOztBRE5BO0VBQ0UsVUFBQTtBQ1NGIiwic291cmNlc0NvbnRlbnQiOlsiYnV0dG9uIHtcbiAgd2lkdGg6IGF1dG87XG4gIGZvbnQtc2l6ZTogMTBweDtcbn1cbnRhYmxlLFxudGQsXG50ciB7XG4gIG1hcmdpbjogMDtcbn1cbnRhYmxlIHtcbiAgd2lkdGg6IDEwMCU7XG59XG4uYWN0aXZlIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDE4MCwgMTM2LCAxMzYpO1xufVxuLnRpdGxlIHtcbiAgZm9udC1zaXplOiAzMHB4O1xufVxuLnN0YWdlLWNvbCB7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbn1cbi5jb2wxIHtcbiAgd2lkdGg6IDIwJTtcbn1cbi5jb2wyIHtcbiAgd2lkdGg6IDgwJTtcbn1cbi5kaXNwbGF5TWVhbF9idG4ge1xuICB3aWR0aDogMTUlO1xufVxuIiwiYnV0dG9uIHtcbiAgd2lkdGg6IGF1dG87XG4gIGZvbnQtc2l6ZTogMTBweDtcbn1cblxudGFibGUsXG50ZCxcbnRyIHtcbiAgbWFyZ2luOiAwO1xufVxuXG50YWJsZSB7XG4gIHdpZHRoOiAxMDAlO1xufVxuXG4uYWN0aXZlIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDE4MCwgMTM2LCAxMzYpO1xufVxuXG4udGl0bGUge1xuICBmb250LXNpemU6IDMwcHg7XG59XG5cbi5zdGFnZS1jb2wge1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG59XG5cbi5jb2wxIHtcbiAgd2lkdGg6IDIwJTtcbn1cblxuLmNvbDIge1xuICB3aWR0aDogODAlO1xufVxuXG4uZGlzcGxheU1lYWxfYnRuIHtcbiAgd2lkdGg6IDE1JTtcbn0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["i0","ArrayDietmealComponent","constructor","route","router","dietBookService","mealService","ngOnInit","queryParams","subscribe","params","dietId","getDietBookById","dietbook","meal","loadDietMeals","dietMealIds","id","getMealById","dietMeals","push","organizeMealsByStage","dietMealsByStage","stage","hasOwnProperty","sort","a","b","nameA","getMealSortName","nameB","mealOrder","indexOf","getRange","nbStage","Array","fill","map","_","index","name","typeMeal","collation","onViewMealForm","activeButtonMeal","navigateByUrl","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["/Users/ericherduin/Htag/Site Web/BD2 Konect/Frontend/src/app/core/array-dietmeal/array-dietmeal.component.html","/Users/ericherduin/Htag/Site Web/BD2 Konect/Frontend/src/app/core/array-dietmeal/array-dietmeal.component.ts"],"sourcesContent":["<!-- <div *ngIf=\"dietbook\">\n  <table>\n    <tr>\n      <th class=\"title stage-col col1\">Étape</th>\n      <th class=\"title stage-col col2\">Repas</th>\n    </tr>\n    <tr *ngFor=\"let stage of getRange(dietbook.nbStage)\">\n      <td class=\"stage-col\">{{ stage }}</td>\n      <td>\n        <span *ngFor=\"let meal of dietMealsByStage[stage]\">\n          <button\n            class=\"displayMeal_btn\"\n            (click)=\"onViewMealForm(meal.id)\"\n            [class.active]=\"activeButtonMeal === meal.id\"\n          >\n            {{\n              meal.typeMeal === \"Collation\" && meal.collation === \"pm1\"\n                ? \"Collation 1\"\n                : meal.typeMeal === \"Collation\" && meal.collation === \"pm2\"\n                ? \"Collation 2\"\n                : meal.typeMeal\n            }}\n          </button>\n        </span>\n      </td>\n    </tr>\n  </table>\n</div> -->\n\n<div *ngIf=\"dietbook\">\n  <table>\n    <tr>\n      <th class=\"title stage-col col1\">Étape</th>\n      <th class=\"title stage-col col2\">Repas</th>\n    </tr>\n    <ng-container *ngFor=\"let stage of getRange(dietbook.nbStage)\">\n      <tr>\n        <td class=\"stage-col\">{{ stage }}</td>\n        <td>\n          <ng-container *ngFor=\"let mealOrderItem of mealOrder\">\n            <ng-container *ngIf=\"dietMealsByStage[stage]\">\n              <span *ngFor=\"let meal of dietMealsByStage[stage]\">\n                <button\n                  class=\"displayMeal_btn\"\n                  (click)=\"onViewMealForm(meal.id)\"\n                  [class.active]=\"activeButtonMeal === meal.id\"\n                  *ngIf=\"getMealSortName(meal) === mealOrderItem\"\n                >\n                  {{ getMealSortName(meal) }}\n                </button>\n              </span>\n            </ng-container>\n            <ng-container *ngIf=\"!dietMealsByStage[stage]\">\n              <!-- Si aucun meal pour cette étape -->\n              <button class=\"displayMeal_btn\">--</button>\n            </ng-container>\n          </ng-container>\n        </td>\n      </tr>\n    </ng-container>\n  </table>\n</div>\n","import { Component, OnInit } from \"@angular/core\";\nimport { ActivatedRoute, Router } from \"@angular/router\";\nimport { DietBooksService } from \"src/app/services/diet-book.service\";\nimport { mealService } from \"src/app/services/meal.service\";\nimport { DietBook } from \"src/app/models/diet.model\";\nimport { Meal } from \"src/app/models/meal.model\";\n\n@Component({\n  selector: \"app-array-dietmeal\",\n  templateUrl: \"./array-dietmeal.component.html\",\n  styleUrls: [\"./array-dietmeal.component.scss\"],\n})\nexport class ArrayDietmealComponent implements OnInit {\n  dietbook: DietBook | null = null;\n  dietMeals: Meal[] = [];\n  dietMealsByStage: { [stage: number]: Meal[] } = {};\n  dietId!: string;\n  activeButtonMeal!: string;\n  mealOrder: string[] = [\n    \"Petit-déjeuner\",\n    \"Collation am\",\n    \"Déjeuner\",\n    \"Collation 1\",\n    \"Collation 2\",\n    \"Diner\",\n  ];\n  constructor(\n    private route: ActivatedRoute,\n    private router: Router,\n    private dietBookService: DietBooksService,\n    private mealService: mealService\n  ) {}\n\n  ngOnInit(): void {\n    this.route.queryParams.subscribe((params) => {\n      this.dietId = params[\"dietId\"];\n\n      this.dietBookService\n        .getDietBookById(this.dietId)\n        .subscribe((dietbook) => {\n          this.dietbook = dietbook;\n          if (dietbook.meal) {\n            this.loadDietMeals(dietbook.meal);\n          }\n        });\n    });\n  }\n\n  loadDietMeals(dietMealIds: string[]): void {\n    for (const id of dietMealIds) {\n      this.mealService.getMealById(id).subscribe((meal) => {\n        this.dietMeals.push(meal);\n        this.organizeMealsByStage();\n      });\n    }\n  }\n  organizeMealsByStage(): void {\n    // Organise les meals par stage dans dietMealsByStage\n    this.dietMealsByStage = {};\n    for (const meal of this.dietMeals) {\n      for (const stage of meal.stage) {\n        if (!this.dietMealsByStage[stage]) {\n          this.dietMealsByStage[stage] = [];\n        }\n        this.dietMealsByStage[stage].push(meal);\n      }\n    }\n    // Trie les meals dans l'ordre de mealOrder\n    for (const stage in this.dietMealsByStage) {\n      if (this.dietMealsByStage.hasOwnProperty(stage)) {\n        this.dietMealsByStage[stage].sort((a, b) => {\n          let nameA = this.getMealSortName(a);\n          let nameB = this.getMealSortName(b);\n\n          return this.mealOrder.indexOf(nameA) - this.mealOrder.indexOf(nameB);\n        });\n      }\n    }\n  }\n\n  getRange(nbStage: number): number[] {\n    return Array(nbStage)\n      .fill(0)\n      .map((_, index) => index + 1);\n  }\n  //renomme les collations am-pm1-pm2\n  getMealSortName(meal: Meal) {\n    let name = meal.typeMeal;\n    let collation = meal.collation;\n\n    if (meal.typeMeal === \"Collation\") {\n      if (collation === \"pm1\") {\n        name += \" 1\";\n      } else if (collation === \"pm2\") {\n        name += \" 2\";\n      } else {\n        name += \" \" + collation;\n      }\n    }\n\n    return name;\n  }\n\n  onViewMealForm(id: string) {\n    this.activeButtonMeal = id;\n    this.router.navigateByUrl(`dietbook?dietId=${this.dietId}&mealId=${id}`);\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}