{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/services/diet-book.service\";\nimport * as i3 from \"src/app/services/meal.service\";\nimport * as i4 from \"@angular/common\";\nfunction ArrayDietmealComponent_div_0_tr_7_span_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"span\")(1, \"button\", 5);\n    i0.ɵɵlistener(\"click\", function ArrayDietmealComponent_div_0_tr_7_span_6_Template_button_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const meal_r5 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r6.onViewMealForm(meal_r5.id));\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const meal_r5 = ctx.$implicit;\n    const ctx_r4 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassProp(\"active\", ctx_r4.activeButtonMeal === meal_r5.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", meal_r5.typeMeal === \"Collation\" && meal_r5.collation === \"pm1\" ? \"Collation 1\" : meal_r5.typeMeal === \"Collation\" && meal_r5.collation === \"pm2\" ? \"Collation 2\" : meal_r5.typeMeal, \" \");\n  }\n}\nfunction ArrayDietmealComponent_div_0_tr_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 4);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵelementContainerStart(4);\n    i0.ɵɵelementContainer(5);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵtemplate(6, ArrayDietmealComponent_div_0_tr_7_span_6_Template, 3, 3, \"span\", 3);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const stage_r3 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(stage_r3);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.dietMealsByStage[stage_r3]);\n  }\n}\nfunction ArrayDietmealComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"table\")(2, \"tr\")(3, \"th\", 1);\n    i0.ɵɵtext(4, \"\\u00C9tape\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\", 2);\n    i0.ɵɵtext(6, \"Repas\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(7, ArrayDietmealComponent_div_0_tr_7_Template, 7, 2, \"tr\", 3);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.getRange(ctx_r0.dietbook.nbStage));\n  }\n}\nfunction ArrayDietmealComponent_div_1_tr_7_ng_container_4_ng_container_1_span_1_button_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 5);\n    i0.ɵɵlistener(\"click\", function ArrayDietmealComponent_div_1_tr_7_ng_container_4_ng_container_1_span_1_button_1_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r20);\n      const meal_r16 = i0.ɵɵnextContext().$implicit;\n      const ctx_r18 = i0.ɵɵnextContext(5);\n      return i0.ɵɵresetView(ctx_r18.onViewMealForm(meal_r16.id));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const meal_r16 = i0.ɵɵnextContext().$implicit;\n    const ctx_r17 = i0.ɵɵnextContext(5);\n    i0.ɵɵclassProp(\"active\", ctx_r17.activeButtonMeal === meal_r16.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r17.getMealSortName(meal_r16) === \"Collation am\" ? \"Collation\" : ctx_r17.getMealSortName(meal_r16), \" \");\n  }\n}\nfunction ArrayDietmealComponent_div_1_tr_7_ng_container_4_ng_container_1_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtemplate(1, ArrayDietmealComponent_div_1_tr_7_ng_container_4_ng_container_1_span_1_button_1_Template, 2, 3, \"button\", 8);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const meal_r16 = ctx.$implicit;\n    const mealName_r11 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r15 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r15.getMealSortName(meal_r16) === mealName_r11);\n  }\n}\nfunction ArrayDietmealComponent_div_1_tr_7_ng_container_4_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, ArrayDietmealComponent_div_1_tr_7_ng_container_4_ng_container_1_span_1_Template, 2, 1, \"span\", 3);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const stage_r9 = i0.ɵɵnextContext(2).$implicit;\n    const ctx_r12 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r12.dietMealsByStage[stage_r9]);\n  }\n}\nfunction ArrayDietmealComponent_div_1_tr_7_ng_container_4_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 9);\n    i0.ɵɵtext(1, \" ------ \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ArrayDietmealComponent_div_1_tr_7_ng_container_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, ArrayDietmealComponent_div_1_tr_7_ng_container_4_ng_container_1_Template, 2, 1, \"ng-container\", 6);\n    i0.ɵɵtemplate(2, ArrayDietmealComponent_div_1_tr_7_ng_container_4_ng_template_2_Template, 2, 0, \"ng-template\", null, 7, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const mealName_r11 = ctx.$implicit;\n    const _r13 = i0.ɵɵreference(3);\n    const stage_r9 = i0.ɵɵnextContext().$implicit;\n    const ctx_r10 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r10.checkMealExists(stage_r9, mealName_r11))(\"ngIfElse\", _r13);\n  }\n}\nfunction ArrayDietmealComponent_div_1_tr_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 4);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtemplate(4, ArrayDietmealComponent_div_1_tr_7_ng_container_4_Template, 4, 2, \"ng-container\", 3);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const stage_r9 = ctx.$implicit;\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(stage_r9);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r8.mealOrder);\n  }\n}\nfunction ArrayDietmealComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"table\")(2, \"tr\")(3, \"th\", 1);\n    i0.ɵɵtext(4, \"\\u00C9tape\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\", 2);\n    i0.ɵɵtext(6, \"Repas\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(7, ArrayDietmealComponent_div_1_tr_7_Template, 5, 2, \"tr\", 3);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.getRange(ctx_r1.dietbook.nbStage));\n  }\n}\nexport class ArrayDietmealComponent {\n  constructor(route, router, dietBookService, mealService) {\n    this.route = route;\n    this.router = router;\n    this.dietBookService = dietBookService;\n    this.mealService = mealService;\n    this.dietbook = null;\n    this.dietMeals = [];\n    this.dietMealsByStage = {};\n    this.mealOrder = [\"Petit-déjeuner\", \"Collation am\", \"Déjeuner\", \"Collation 1\", \"Collation 2\", \"Diner\"];\n  }\n  ngOnInit() {\n    this.route.queryParams.subscribe(params => {\n      this.dietId = params[\"dietId\"];\n      this.dietBookService.getDietBookById(this.dietId).subscribe(dietbook => {\n        this.dietbook = dietbook;\n        if (dietbook.meal) {\n          this.loadDietMeals(dietbook.meal);\n        }\n      });\n    });\n  }\n  loadDietMeals(dietMealIds) {\n    for (const id of dietMealIds) {\n      this.mealService.getMealById(id).subscribe(meal => {\n        this.dietMeals.push(meal);\n        this.organizeMealsByStage();\n      });\n    }\n  }\n  organizeMealsByStage() {\n    // Organise les meals par stage dans dietMealsByStage\n    this.dietMealsByStage = {};\n    for (const meal of this.dietMeals) {\n      for (const stage of meal.stage) {\n        if (!this.dietMealsByStage[stage]) {\n          this.dietMealsByStage[stage] = [];\n        }\n        this.dietMealsByStage[stage].push(meal);\n      }\n    }\n    // Trie les meals dans l'ordre de mealOrder\n    for (const stage in this.dietMealsByStage) {\n      if (this.dietMealsByStage.hasOwnProperty(stage)) {\n        this.dietMealsByStage[stage].sort((a, b) => {\n          let nameA = this.getMealSortName(a);\n          let nameB = this.getMealSortName(b);\n          return this.mealOrder.indexOf(nameA) - this.mealOrder.indexOf(nameB);\n        });\n      }\n    }\n  }\n  getRange(nbStage) {\n    return Array(nbStage).fill(0).map((_, index) => index + 1);\n  }\n  //renomme les collations am-pm1-pm2\n  getMealSortName(meal) {\n    let name = meal.typeMeal;\n    let collation = meal.collation;\n    if (meal.typeMeal === \"Collation\") {\n      if (collation === \"pm1\") {\n        name += \" 1\";\n      } else if (collation === \"pm2\") {\n        name += \" 2\";\n      } else {\n        name += \" \" + collation;\n      }\n    }\n    return name;\n  }\n  checkMealExists(stage, mealName) {\n    const meal = this.dietMealsByStage[stage]?.find(meal => this.getMealSortName(meal) === mealName);\n    return !!meal;\n  }\n  onViewMealForm(id) {\n    this.activeButtonMeal = id;\n    this.router.navigateByUrl(`dietbook?dietId=${this.dietId}&mealId=${id}`);\n  }\n  static #_ = this.ɵfac = function ArrayDietmealComponent_Factory(t) {\n    return new (t || ArrayDietmealComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.DietBooksService), i0.ɵɵdirectiveInject(i3.mealService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ArrayDietmealComponent,\n    selectors: [[\"app-array-dietmeal\"]],\n    decls: 2,\n    vars: 2,\n    consts: [[4, \"ngIf\"], [1, \"title\", \"stage-col\", \"col1\"], [1, \"title\", \"stage-col\", \"col2\"], [4, \"ngFor\", \"ngForOf\"], [1, \"stage-col\"], [1, \"displayMeal_btn\", 3, \"click\"], [4, \"ngIf\", \"ngIfElse\"], [\"emptySpace\", \"\"], [\"class\", \"displayMeal_btn\", 3, \"active\", \"click\", 4, \"ngIf\"], [1, \"empty-space\"]],\n    template: function ArrayDietmealComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, ArrayDietmealComponent_div_0_Template, 8, 1, \"div\", 0);\n        i0.ɵɵtemplate(1, ArrayDietmealComponent_div_1_Template, 8, 1, \"div\", 0);\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.dietbook);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.dietbook);\n      }\n    },\n    dependencies: [i4.NgForOf, i4.NgIf],\n    styles: [\"@charset \\\"UTF-8\\\";\\nbutton[_ngcontent-%COMP%] {\\n  width: auto;\\n  font-size: 10px;\\n}\\n\\ntable[_ngcontent-%COMP%], td[_ngcontent-%COMP%], tr[_ngcontent-%COMP%] {\\n  margin: 0;\\n}\\n\\ntable[_ngcontent-%COMP%] {\\n  width: 100%;\\n}\\n\\n.active[_ngcontent-%COMP%] {\\n  background-color: rgb(180, 136, 136);\\n}\\n\\n.title[_ngcontent-%COMP%] {\\n  font-size: 30px;\\n}\\n\\n.stage-col[_ngcontent-%COMP%] {\\n  text-align: center;\\n}\\n\\n.col1[_ngcontent-%COMP%] {\\n  width: 20%;\\n}\\n\\n.col2[_ngcontent-%COMP%] {\\n  width: 80%;\\n}\\n\\ntd.span[_ngcontent-%COMP%] {\\n  display: inline-block;\\n  width: 30px;\\n}\\n\\n.empty-space[_ngcontent-%COMP%], .displayMeal_btn[_ngcontent-%COMP%] {\\n  display: inline-block;\\n  width: 75px; \\n  text-align: center; \\n  margin-right: 5px; \\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uLy4uLy4uLy4uL1NpdGUlMjBXZWIvQkQyJTIwS29uZWN0L0Zyb250ZW5kL3NyYy9hcHAvY29yZS9hcnJheS1kaWV0bWVhbC9hcnJheS1kaWV0bWVhbC5jb21wb25lbnQuc2NzcyIsIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29yZS9hcnJheS1kaWV0bWVhbC9hcnJheS1kaWV0bWVhbC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxnQkFBZ0I7QUNBaEI7RUFDRSxXQUFBO0VBQ0EsZUFBQTtBREVGOztBQ0FBOzs7RUFHRSxTQUFBO0FER0Y7O0FDREE7RUFDRSxXQUFBO0FESUY7O0FDRkE7RUFDRSxvQ0FBQTtBREtGOztBQ0hBO0VBQ0UsZUFBQTtBRE1GOztBQ0pBO0VBQ0Usa0JBQUE7QURPRjs7QUNMQTtFQUNFLFVBQUE7QURRRjs7QUNOQTtFQUNFLFVBQUE7QURTRjs7QUNQQTtFQUNFLHFCQUFBO0VBQ0EsV0FBQTtBRFVGOztBQ1JBOztFQUVFLHFCQUFBO0VBQ0EsV0FBQSxFQUFBLHlDQUFBO0VBQ0Esa0JBQUEsRUFBQSxvQ0FBQTtFQUNBLGlCQUFBLEVBQUEsc0RBQUE7QURXRiIsInNvdXJjZXNDb250ZW50IjpbIkBjaGFyc2V0IFwiVVRGLThcIjtcbmJ1dHRvbiB7XG4gIHdpZHRoOiBhdXRvO1xuICBmb250LXNpemU6IDEwcHg7XG59XG5cbnRhYmxlLFxudGQsXG50ciB7XG4gIG1hcmdpbjogMDtcbn1cblxudGFibGUge1xuICB3aWR0aDogMTAwJTtcbn1cblxuLmFjdGl2ZSB7XG4gIGJhY2tncm91bmQtY29sb3I6IHJnYigxODAsIDEzNiwgMTM2KTtcbn1cblxuLnRpdGxlIHtcbiAgZm9udC1zaXplOiAzMHB4O1xufVxuXG4uc3RhZ2UtY29sIHtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xufVxuXG4uY29sMSB7XG4gIHdpZHRoOiAyMCU7XG59XG5cbi5jb2wyIHtcbiAgd2lkdGg6IDgwJTtcbn1cblxudGQuc3BhbiB7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgd2lkdGg6IDMwcHg7XG59XG5cbi5lbXB0eS1zcGFjZSxcbi5kaXNwbGF5TWVhbF9idG4ge1xuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gIHdpZHRoOiA3NXB4OyAvKiBBanVzdGV6IGxhIGxhcmdldXIgc2Vsb24gdm9zIGJlc29pbnMgKi9cbiAgdGV4dC1hbGlnbjogY2VudGVyOyAvKiBGYWN1bHRhdGlmIDogY2VudHJleiBsZSBjb250ZW51ICovXG4gIG1hcmdpbi1yaWdodDogNXB4OyAvKiBGYWN1bHRhdGlmIDogYWpvdXRleiB1bmUgbWFyZ2UgZW50cmUgbGVzIMODwqlsw4PCqW1lbnRzICovXG59IiwiYnV0dG9uIHtcbiAgd2lkdGg6IGF1dG87XG4gIGZvbnQtc2l6ZTogMTBweDtcbn1cbnRhYmxlLFxudGQsXG50ciB7XG4gIG1hcmdpbjogMDtcbn1cbnRhYmxlIHtcbiAgd2lkdGg6IDEwMCU7XG59XG4uYWN0aXZlIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDE4MCwgMTM2LCAxMzYpO1xufVxuLnRpdGxlIHtcbiAgZm9udC1zaXplOiAzMHB4O1xufVxuLnN0YWdlLWNvbCB7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbn1cbi5jb2wxIHtcbiAgd2lkdGg6IDIwJTtcbn1cbi5jb2wyIHtcbiAgd2lkdGg6IDgwJTtcbn1cbnRkLnNwYW4ge1xuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gIHdpZHRoOiAzMHB4O1xufVxuLmVtcHR5LXNwYWNlLFxuLmRpc3BsYXlNZWFsX2J0biB7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgd2lkdGg6IDc1cHg7IC8qIEFqdXN0ZXogbGEgbGFyZ2V1ciBzZWxvbiB2b3MgYmVzb2lucyAqL1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7IC8qIEZhY3VsdGF0aWYgOiBjZW50cmV6IGxlIGNvbnRlbnUgKi9cbiAgbWFyZ2luLXJpZ2h0OiA1cHg7IC8qIEZhY3VsdGF0aWYgOiBham91dGV6IHVuZSBtYXJnZSBlbnRyZSBsZXMgw4PCqWzDg8KpbWVudHMgKi9cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["i0","ArrayDietmealComponent","constructor","route","router","dietBookService","mealService","ngOnInit","queryParams","subscribe","params","dietId","getDietBookById","dietbook","meal","loadDietMeals","dietMealIds","id","getMealById","dietMeals","push","organizeMealsByStage","dietMealsByStage","stage","hasOwnProperty","sort","a","b","nameA","getMealSortName","nameB","mealOrder","indexOf","getRange","nbStage","Array","fill","map","_","index","name","typeMeal","collation","checkMealExists","mealName","find","onViewMealForm","activeButtonMeal","navigateByUrl","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["/Users/ericherduin/Htag/Site Web/BD2 Konect/Frontend/src/app/core/array-dietmeal/array-dietmeal.component.html","/Users/ericherduin/Htag/Site Web/BD2 Konect/Frontend/src/app/core/array-dietmeal/array-dietmeal.component.ts"],"sourcesContent":["<div *ngIf=\"dietbook\">\n  <table>\n    <tr>\n      <th class=\"title stage-col col1\">Étape</th>\n      <th class=\"title stage-col col2\">Repas</th>\n    </tr>\n    <tr *ngFor=\"let stage of getRange(dietbook.nbStage)\">\n      <td class=\"stage-col\">{{ stage }}</td>\n      <td>\n        <ng-container>\n          <ng-container> </ng-container>\n        </ng-container>\n        <span *ngFor=\"let meal of dietMealsByStage[stage]\">\n          <button\n            class=\"displayMeal_btn\"\n            (click)=\"onViewMealForm(meal.id)\"\n            [class.active]=\"activeButtonMeal === meal.id\"\n          >\n            {{\n              meal.typeMeal === \"Collation\" && meal.collation === \"pm1\"\n                ? \"Collation 1\"\n                : meal.typeMeal === \"Collation\" && meal.collation === \"pm2\"\n                ? \"Collation 2\"\n                : meal.typeMeal\n            }}\n          </button>\n        </span>\n      </td>\n    </tr>\n  </table>\n</div>\n<div *ngIf=\"dietbook\">\n  <table>\n    <tr>\n      <th class=\"title stage-col col1\">Étape</th>\n      <th class=\"title stage-col col2\">Repas</th>\n    </tr>\n    <tr *ngFor=\"let stage of getRange(dietbook.nbStage)\">\n      <td class=\"stage-col\">{{ stage }}</td>\n      <td>\n        <ng-container *ngFor=\"let mealName of mealOrder\">\n          <ng-container\n            *ngIf=\"checkMealExists(stage, mealName); else emptySpace\"\n          >\n            <span *ngFor=\"let meal of dietMealsByStage[stage]\">\n              <button\n                class=\"displayMeal_btn\"\n                (click)=\"onViewMealForm(meal.id)\"\n                [class.active]=\"activeButtonMeal === meal.id\"\n                *ngIf=\"getMealSortName(meal) === mealName\"\n              >\n                {{\n                  getMealSortName(meal) === \"Collation am\"\n                    ? \"Collation\"\n                    : getMealSortName(meal)\n                }}\n              </button>\n            </span>\n          </ng-container>\n          <ng-template #emptySpace>\n            <!-- Espace vide -->\n            <span class=\"empty-space\"> ------ </span>\n          </ng-template>\n        </ng-container>\n      </td>\n    </tr>\n  </table>\n</div>\n","import { Component, OnInit } from \"@angular/core\";\nimport { ActivatedRoute, Router } from \"@angular/router\";\nimport { DietBooksService } from \"src/app/services/diet-book.service\";\nimport { mealService } from \"src/app/services/meal.service\";\nimport { DietBook } from \"src/app/models/diet.model\";\nimport { Meal } from \"src/app/models/meal.model\";\n\n@Component({\n  selector: \"app-array-dietmeal\",\n  templateUrl: \"./array-dietmeal.component.html\",\n  styleUrls: [\"./array-dietmeal.component.scss\"],\n})\nexport class ArrayDietmealComponent implements OnInit {\n  dietbook: DietBook | null = null;\n  dietMeals: Meal[] = [];\n  dietMealsByStage: { [stage: number]: Meal[] } = {};\n  dietId!: string;\n  activeButtonMeal!: string;\n  mealOrder: string[] = [\n    \"Petit-déjeuner\",\n    \"Collation am\",\n    \"Déjeuner\",\n    \"Collation 1\",\n    \"Collation 2\",\n    \"Diner\",\n  ];\n  constructor(\n    private route: ActivatedRoute,\n    private router: Router,\n    private dietBookService: DietBooksService,\n    private mealService: mealService\n  ) {}\n\n  ngOnInit(): void {\n    this.route.queryParams.subscribe((params) => {\n      this.dietId = params[\"dietId\"];\n\n      this.dietBookService\n        .getDietBookById(this.dietId)\n        .subscribe((dietbook) => {\n          this.dietbook = dietbook;\n          if (dietbook.meal) {\n            this.loadDietMeals(dietbook.meal);\n          }\n        });\n    });\n  }\n\n  loadDietMeals(dietMealIds: string[]): void {\n    for (const id of dietMealIds) {\n      this.mealService.getMealById(id).subscribe((meal) => {\n        this.dietMeals.push(meal);\n        this.organizeMealsByStage();\n      });\n    }\n  }\n  organizeMealsByStage(): void {\n    // Organise les meals par stage dans dietMealsByStage\n    this.dietMealsByStage = {};\n    for (const meal of this.dietMeals) {\n      for (const stage of meal.stage) {\n        if (!this.dietMealsByStage[stage]) {\n          this.dietMealsByStage[stage] = [];\n        }\n        this.dietMealsByStage[stage].push(meal);\n      }\n    }\n    // Trie les meals dans l'ordre de mealOrder\n    for (const stage in this.dietMealsByStage) {\n      if (this.dietMealsByStage.hasOwnProperty(stage)) {\n        this.dietMealsByStage[stage].sort((a, b) => {\n          let nameA = this.getMealSortName(a);\n          let nameB = this.getMealSortName(b);\n\n          return this.mealOrder.indexOf(nameA) - this.mealOrder.indexOf(nameB);\n        });\n      }\n    }\n  }\n\n  getRange(nbStage: number): number[] {\n    return Array(nbStage)\n      .fill(0)\n      .map((_, index) => index + 1);\n  }\n  //renomme les collations am-pm1-pm2\n  getMealSortName(meal: Meal) {\n    let name = meal.typeMeal;\n    let collation = meal.collation;\n\n    if (meal.typeMeal === \"Collation\") {\n      if (collation === \"pm1\") {\n        name += \" 1\";\n      } else if (collation === \"pm2\") {\n        name += \" 2\";\n      } else {\n        name += \" \" + collation;\n      }\n    }\n\n    return name;\n  }\n  checkMealExists(stage: number, mealName: string): boolean {\n    const meal = this.dietMealsByStage[stage]?.find(\n      (meal) => this.getMealSortName(meal) === mealName\n    );\n    return !!meal;\n  }\n\n  onViewMealForm(id: string) {\n    this.activeButtonMeal = id;\n    this.router.navigateByUrl(`dietbook?dietId=${this.dietId}&mealId=${id}`);\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}